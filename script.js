console.log('ok');

lst = [
    {
      title: 'Second Foundation (Foundation, #3)',
      price: '444.00',
      url: 'https://99bookscart.com/products/second-foundation-foundation-3?_pos=1&amp;_sid=3c34fd3ad&amp;_ss=r'
    },
    {
      title: 'Utopia Isaac Asimovs Caliban #3-Roger Macbride Allen',
      price: '344',
      url: 'https://www.usedbooksfactory.com/buy-second-hand-old-books/detail/utopia-isaac-asimovs-caliban-3-roger-macbride-allen-new-editionedition-9780752809861?book_id=52587'
    },
    {
      title: 'Mythology And The Universe Isaac Asimovs Library Of The Universe-Isaac Asimov',
      price: '1292',
      url: 'https://www.usedbooksfactory.com/buy-second-hand-old-books/detail/mythology-and-the-universe-isaac-asimovs-library-of-the-universe-isaac-asimov-reprintedition-9780440404491?book_id=60499'
    },
    {
      title: 'Asimovs Guide To Halleys Comet-Asimov Isaac',
      price: '599',
      url: 'https://www.usedbooksfactory.com/buy-second-hand-old-books/detail/asimovs-guide-to-halleys-comet-asimov-isaac-1985-01-01edition-0802708366?book_id=31816'
    },
    {
      title: 'How Is Paper Made-Isaac Asimov',
      price: '7569',
      url: 'https://www.usedbooksfactory.com/buy-second-hand-old-books/detail/how-is-paper-made-isaac-asimov-naedition-9780431076478?book_id=67935'
    },
    {
      title: 'The Ends Of The Earth The Polar Regions Of The World-Isaac Asimov Bob Hines ',
      price: '4414',
      url: 'https://www.usedbooksfactory.com/buy-second-hand-old-books/detail/the-ends-of-the-earth-the-polar-regions-of-the-world-isaac-asimov-bob-hines-not-availableedition-0679401237?book_id=58391'
    },
    {
      title: '100 Malicious Little Mysteries-Isaac Asimov Joseph D Olander Martin H Greenberg ',
      price: '1228',
      url: 'https://www.usedbooksfactory.com/buy-second-hand-old-books/detail/100-malicious-little-mysteries-isaac-asimov-joseph-d-olander-martin-h-greenberg-naedition-9780880297691?book_id=71882'
    },
    {
      title: 'The Birth Of The United States1763 1816-Asimov Isaac',
      price: '797',
      url: 'https://www.usedbooksfactory.com/buy-second-hand-old-books/detail/the-birth-of-the-united-states1763-1816-asimov-isaac-1973-02-01edition-0395184517?book_id=31747'
    },
    {
      title: 'Facts And Trivia-Isaac Asimov',
      price: '310',
      url: 'https://www.usedbooksfactory.com/buy-second-hand-old-books/detail/facts-and-trivia-isaac-asimov-not-availableedition-9780752528229?book_id=52582'
    },
    {
      title: 'Is Our Planet Warming Up-Isaac Asimov',
      price: '310',
      url: 'https://www.usedbooksfactory.com/buy-second-hand-old-books/detail/is-our-planet-warming-up-isaac-asimov-not-availableedition-9780431076409?book_id=54545'
    },
    {
      title: 'Foundation And Empire Foundation #2-Isaac Asimov',
      price: '1108',
      url: 'https://www.usedbooksfactory.com/buy-second-hand-old-books/detail/foundation-and-empire-foundation-2-isaac-asimov-paperbackedition-9780553293371?book_id=59235'
    },
    {
      title: 'Atom Journey Across The Subatomic Cosmos Truman Talley-Asimov Isaac',
      price: '1293',
      url: 'https://www.usedbooksfactory.com/buy-second-hand-old-books/detail/atom-journey-across-the-subatomic-cosmos-truman-talley-asimov-isaac-1992-08-01edition-9780452268340?book_id=34582'
    },
    {
      title: 'Quasar Quasar Burning Bright-Isaac Asimov',
      price: '1400',
      url: 'https://www.usedbooksfactory.com/buy-second-hand-old-books/detail/quasar-quasar-burning-bright-isaac-asimov-naedition-0385134649?book_id=73932'
    },
    {
      title: 'The Machinery of Life',
      price: '130',
      url: 'https://kitabay.com/products/the-machinery-of-life?_pos=1&amp;_sid=83d7bc970&amp;_ss=r'
    },
    {
        title: 'Foundation by Asimov',
      price: '199',
      url: 'https://halfpricebooks.in/products/foundation-by-asimov?_pos=1&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
      title: 'Issac Asimov by Foundation',
      price: '199',
      url: 'https://halfpricebooks.in/products/issac-asimov-by-foundation?_pos=2&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
        title: 'The Currents of Space by Isaac Asimov',
      price: '989',
      url: 'https://halfpricebooks.in/products/the-currents-of-space-by-isaac-asimov?_pos=3&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
        title:'Asimov on science fiction by Isaac Asimov',
      price: '299',
      url: 'https://halfpricebooks.in/products/asimov-on-science-fiction-by-isaac-asimov?_pos=4&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
        title: 'The Neutrino, By Isaac Asimov',
      price: '99',
      url: 'https://halfpricebooks.in/products/the-neutrino-by-isaac-asimov-2?_pos=5&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
        title: 'The Neutrino By Isaac Asimov',
      price: '99',
      url: 'https://halfpricebooks.in/products/the-neutrino-by-isaac-asimov-1?_pos=6&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
        title:' 50 Mysteries by Isaac Asimov',
      price: '59',
      url: 'https://halfpricebooks.in/products/50-mysteries-by-isaac-asimov?_pos=7&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
        title:' SPACE MAIL by Isaac Asimov',
      price: '399',
      url: 'https://halfpricebooks.in/products/space-mail-by-isaac-asimov?_pos=8&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
        title:'The Neutrino by Isaac Asimov',
      price: '39',
      url: 'https://halfpricebooks.in/products/the-neutrino-by-isaac-asimov?_pos=9&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
        title: 'The Complete Robot by Issac Asimov',
      price: '199',
      url: 'https://halfpricebooks.in/products/the-complete-robot-by-issac-asimov?_pos=10&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
        title: 'On Science Fiction by Isaac Asimov',
      price: '69',
      url: 'https://halfpricebooks.in/products/on-science-fiction-by-isaac-asimov?_pos=11&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
        title: '50 More Mysteries by Isaac Asimov',
      price: '69',
      url: 'https://halfpricebooks.in/products/50-more-mysteries-by-isaac-asimov?_pos=12&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
        title: 'Forward the Foundation by Asimov Isaac',
      price: '79',
      url: 'https://halfpricebooks.in/products/forward-the-foundation-by-asimov-isaac?_pos=13&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
        title: 'Issac Asimov - How we found about Dinosaurs',
      price: '149',
      url: 'https://halfpricebooks.in/products/issac-asimov-how-we-found-about-dinosaurs?_pos=14&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
        title: 'Forward the Foundation (Foundation Novels)  by Isaac Asimov',
      price: '69',
      url: 'https://halfpricebooks.in/products/forward-the-foundation-foundation-novels-by-isaac-asimov?_pos=15&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
    title: 'Understanding Physics: Volume 1: Motion, Sound and Heat by Isaac Asimov',
      price: '49',
      url: 'https://halfpricebooks.in/products/understanding-physics-volume-1-motion-sound-and-heat-by-isaac-asimov?_pos=16&amp;_sid=2d7f89a91&amp;_ss=r'
    },
    {
      title: 'Robots and Empire',
      price: '150',
      url: 'https://bestofusedbooks.com//products/robots-and-empire?_pos=1&amp;_sid=3ec2db9a9&amp;_ss=r'
    },
    {
      title: 'The Caves of Steel',
      price: '150',
      url: 'https://bestofusedbooks.com//products/the-caves-of-steel?_pos=2&amp;_sid=3ec2db9a9&amp;_ss=r'
    },
    {
      title: 'ISAAC ASIMOV',
      price: '99',
      url: 'https://bestofusedbooks.com//products/isaac-asimov?_pos=3&amp;_sid=3ec2db9a9&amp;_ss=r'
    },
    {
      title: 'Complete Short Stories - I',
      price: '150',
      url: 'https://bestofusedbooks.com//products/complete-short-stories-i?_pos=4&amp;_sid=3ec2db9a9&amp;_ss=r'
    },
    {
      title: 'I, Robot',
      price: '150',
      url: 'https://bestofusedbooks.com//products/i-robot?_pos=5&amp;_sid=3ec2db9a9&amp;_ss=r'
    },
    {
      title: "Asimov's Guide to the Bible:  [Two Volumes in One] the Old and New Testaments [Hardcover]",
      price: 'ass="price-item price-item--regular">Rs. 1,999',
      url: 'https://bestofusedbooks.com//products/asimovs-guide-to-the-bible-two-volumes-in-one-the-old-and-new-testaments-hardcover?_pos=6&amp;_sid=3ec2db9a9&amp;_ss=r'
    },
    {
      title: 'Foundation',
      price: '99',
      url: 'https://bestofusedbooks.com//products/foundation?_pos=7&amp;_sid=3ec2db9a9&amp;_ss=r'
    },
    {
      title: 'The End Of Eternity',
      price: '99',
      url: 'https://bestofusedbooks.com//products/the-end-of-eternity?_pos=8&amp;_sid=3ec2db9a9&amp;_ss=r'
    },
    {
      title: 'Nemesis',
      price: '99',
      url: 'https://bestofusedbooks.com//products/nemesis-1?_pos=9&amp;_sid=3ec2db9a9&amp;_ss=r'
    },
    {
      title: 'Forward the Foundation',
      price: '150',
      url: 'https://bestofusedbooks.com//products/forward-the-foundation?_pos=10&amp;_sid=3ec2db9a9&amp;_ss=r'
    }
  ]

function printer(lst) {

  for (let i = 0; i < lst.length; i++) {

      const box = document.createElement("div");
      box.classList.add("box");
      const book = document.createElement("ul");
      const title = document.createElement("li");
      const price = document.createElement("li");
      const urlEl = document.createElement("li");
      const url = document.createElement("button");
      title.innerText = "Title: " + lst[i].title;
      price.innerText = "Price: â‚¹" + lst[i].price;
      url.innerText = "Link";
      url.onclick = function() {
        window.open(lst[i].url)
      }

      box.appendChild(book);
      book.appendChild(title);
      book.appendChild(price);
      book.appendChild(urlEl)
      urlEl.appendChild(url);
      results = document.querySelector(".results")
      results.appendChild(box);

  }

//   console.log(inp);

}

async function fetcher(inp) {
    resultsbox = document.querySelector(".results")
    resultsbox.innerHTML = "";
    const loading = document.createElement("h3");
    loading.innerText = "Browsing for results...";
    
    resultsbox.appendChild(loading);
    await fetch('http://localhost:8080/getter/' + inp)
        .then(res => res.json())
        .then(data => {
            
            
            loading.innerText = "Results: ";
            resultsbox.appendChild(loading);
            printer(data)
        });

    

    // printer(inp);
    // console.log(inp);
}

const search_btn = document.querySelector(".search-button");

document.querySelector("#search-bar").addEventListener("keyup", function(event) {
    if (event.keyCode === 13) {
      event.preventDefault();
      search_btn.click();
    }
  });

search_btn.onclick = async function() {

    const inp = document.querySelector("#search-bar");
    if (inp.value === "") {
        alert("Enter a query");
    } else {
        fetcher(inp.value);
        inp.value = "";
        

    }
}
